<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>epitraxr • epitraxr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="epitraxr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epitraxr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/epitraxr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>epitraxr</h1>
            
      

      <div class="d-none name"><code>epitraxr.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction-to-epitraxr">Introduction to epitraxr<a class="anchor" aria-label="anchor" href="#introduction-to-epitraxr"></a>
</h2>
<p>EpiTrax is a central repository for epidemiological data developed by
Utah State’s Department of Health and Human Services (DHHS). It is now
used by several other states. Through EpiTrax, public health officials
have access to many different types of disease surveillance data, which
they use to produce regular (e.g., weekly, monthly, annual) reports on
their respective jurisdictions. This can be a tedious, time-intensive
process.</p>
<p>The epitraxr package makes it fast and easy to process EpiTrax data
and produce multiple reports.</p>
<div class="section level3">
<h3 id="epitrax-data">EpiTrax Data<a class="anchor" aria-label="anchor" href="#epitrax-data"></a>
</h3>
<p>To explore basic report functions in epitraxr, we’ll use the sample
dataset included in the package. This can be read in using the
<code><a href="../reference/read_epitrax_data.html">read_epitrax_data()</a></code> function:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"sample_data/sample_epitrax_data.csv"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"epitraxr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">data_file</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patient_mmwr_week patient_mmwr_year patient_disease</span></span>
<span><span class="co">#&gt; 1                31              2020       Influenza</span></span>
<span><span class="co">#&gt; 2                51              2019       Influenza</span></span>
<span><span class="co">#&gt; 3                27              2021       Influenza</span></span>
<span><span class="co">#&gt; 4                30              2024        COVID-19</span></span>
<span><span class="co">#&gt; 5                24              2020       Influenza</span></span>
<span><span class="co">#&gt; 6                13              2022       Influenza</span></span></code></pre></div>
<p>When you export data from EpiTrax, each row corresponds to a single
disease case. In general, this will also correspond to a single patient,
but if a patient is diagnosed with multiple diseases they will have a
separate row in the data for each disease.</p>
<p>EpiTrax can provide many different data points, but epitraxr only
cares about three:</p>
<ul>
<li>
<code>patient_disease</code>: The disease</li>
<li>
<code>patient_mmwr_week</code>: The week number (1-52) of disease
onset</li>
<li>
<code>patient_mmwr_year</code>: The year of disease onset</li>
</ul>
<p>The package ignores all other columns.</p>
<p>We read the data in using the <code><a href="../reference/read_epitrax_data.html">read_epitrax_data()</a></code>
function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">epitrax_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_epitrax_data.html">read_epitrax_data</a></span><span class="op">(</span><span class="va">data_file</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">epitrax_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;     disease month year counts</span></span>
<span><span class="co">#&gt; 1 Influenza     8 2020      1</span></span>
<span><span class="co">#&gt; 2 Influenza    12 2019      1</span></span>
<span><span class="co">#&gt; 3 Influenza     7 2021      1</span></span>
<span><span class="co">#&gt; 4  COVID-19     7 2024      1</span></span>
<span><span class="co">#&gt; 5 Influenza     6 2020      1</span></span>
<span><span class="co">#&gt; 6 Influenza     4 2022      1</span></span></code></pre></div>
<p>This validates the input data and converts the week number to a month
number (1-12), because reports generally use months instead of weeks.
The function also adds the <code>counts</code> column (initially all
rows have a count of 1), which is used internally in manipulating the
data while generating reports.</p>
</div>
<div class="section level3">
<h3 id="generating-reports-standard-mode">Generating Reports: Standard Mode<a class="anchor" aria-label="anchor" href="#generating-reports-standard-mode"></a>
</h3>
<p>We have the data, but before we can begin generating reports from it,
we need a list of diseases to include in the report. Often, you’ll have
two lists, one for internal reports and one for public reports. These
lists might include diseases that aren’t included in the dataset, but
which you are tracking and reporting. If you had a specific list you
wanted to use, you could read those in using the functions
<code><a href="../reference/get_internal_disease_list.html">get_internal_disease_list()</a></code> and
<code><a href="../reference/get_public_disease_list.html">get_public_disease_list()</a></code>. For this example, we’ll simply
use the diseases in the dataset:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diseases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">epitrax_data</span><span class="op">$</span><span class="va">disease</span><span class="op">)</span></span></code></pre></div>
<p>We can now call one of the report creation functions:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">report</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_report_annual_counts.html">create_report_annual_counts</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">epitrax_data</span>,</span>
<span>  disease_names <span class="op">=</span> <span class="va">diseases</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">report</span></span>
<span><span class="co">#&gt;      disease 2019 2020 2021 2022 2023 2024</span></span>
<span><span class="co">#&gt; 1 Chickenpox  218  318  263  234  249  292</span></span>
<span><span class="co">#&gt; 2   COVID-19 1014 1627 2398 1855  908 1191</span></span>
<span><span class="co">#&gt; 3  Influenza  625 1733 1889 2289 1664 1466</span></span>
<span><span class="co">#&gt; 4    Measles  211  326  292  414  586  304</span></span>
<span><span class="co">#&gt; 5   Syphilis  278  356  439  398  577  269</span></span></code></pre></div>
<p>This gives us a data frame containing a row for each disease in our
disease list and a column showing the case counts for each year in the
dataset.</p>
<p>Let’s call the report function again, but this time give it a
different disease list.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">report</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_report_annual_counts.html">create_report_annual_counts</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">epitrax_data</span>,</span>
<span>  disease_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chickenpox"</span>, <span class="st">"Measles"</span>, <span class="st">"Lyme disease"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">report</span></span>
<span><span class="co">#&gt;        disease 2019 2020 2021 2022 2023 2024</span></span>
<span><span class="co">#&gt; 1   Chickenpox  218  318  263  234  249  292</span></span>
<span><span class="co">#&gt; 2 Lyme disease    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; 3      Measles  211  326  292  414  586  304</span></span></code></pre></div>
<p>This new report only includes three diseases and shows there are no
cases of “Lyme disease” in the dataset.</p>
</div>
<div class="section level3">
<h3 id="generating-reports-piped-mode-recommended">Generating Reports: Piped Mode (recommended)<a class="anchor" aria-label="anchor" href="#generating-reports-piped-mode-recommended"></a>
</h3>
<p>The epitraxr package includes a separate piping mode to make it easy
to chain together multiple reports without needing to specify the
disease list and input data each time. This family of functions has the
prefix <code>epitrax_</code>. Report functions within this family have
one of two prefixes: <code>epitrax_preports_</code> or
<code>epitrax_ireports_</code>, which correspond to public and internal
reports respectively.</p>
<p>In piping mode you first setup an <code>epitrax</code> object which
will contain the data and configuration options needed for all reports.
As each report function is called, the report is appended to the
appropriate list in the epitrax object and the epitrax object is passed
to the next function.</p>
<p>Let’s look at the same annual counts report generation using the
piping method. For this method, we need the disease list to be in a CSV
file and we also need to provide a list of configuration options. These
are discussed in more detail in other vignettes.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">config_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"sample_data/sample_config.yml"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"epitraxr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">disease_list_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"sample_data/sample_disease_list.csv"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"epitraxr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">epitrax</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_epitrax.html">get_epitrax</a></span><span class="op">(</span><span class="va">data_file</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/epitrax_set_config_from_file.html">epitrax_set_config_from_file</a></span><span class="op">(</span><span class="va">config_file</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/epitrax_add_report_diseases.html">epitrax_add_report_diseases</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    internal <span class="op">=</span> <span class="va">disease_list_file</span>,</span>
<span>    public <span class="op">=</span> <span class="va">disease_list_file</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/epitrax_ireport_annual_counts.html">epitrax_ireport_annual_counts</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">epitrax</span><span class="op">$</span><span class="va">internal_reports</span><span class="op">$</span><span class="va">annual_counts</span></span>
<span><span class="co">#&gt;        disease 2019 2020 2021 2022 2023 2024</span></span>
<span><span class="co">#&gt; 1   Chickenpox  218  318  263  234  249  292</span></span>
<span><span class="co">#&gt; 2 Lyme disease    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; 3      Measles  211  326  292  414  586  304</span></span></code></pre></div>
<p>The piping method can feel like overkill for generating a single
report, but it really shines when we’re creating multiple reports all at
once.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">epitrax</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_epitrax.html">get_epitrax</a></span><span class="op">(</span><span class="va">data_file</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/epitrax_set_config_from_file.html">epitrax_set_config_from_file</a></span><span class="op">(</span><span class="va">config_file</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/epitrax_add_report_diseases.html">epitrax_add_report_diseases</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    internal <span class="op">=</span> <span class="va">disease_list_file</span>,</span>
<span>    public <span class="op">=</span> <span class="va">disease_list_file</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/epitrax_ireport_annual_counts.html">epitrax_ireport_annual_counts</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/epitrax_ireport_monthly_avgs.html">epitrax_ireport_monthly_avgs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/epitrax_ireport_ytd_counts_for_month.html">epitrax_ireport_ytd_counts_for_month</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">epitrax</span><span class="op">$</span><span class="va">internal_reports</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$annual_counts</span></span>
<span><span class="co">#&gt;        disease 2019 2020 2021 2022 2023 2024</span></span>
<span><span class="co">#&gt; 1   Chickenpox  218  318  263  234  249  292</span></span>
<span><span class="co">#&gt; 2 Lyme disease    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; 3      Measles  211  326  292  414  586  304</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$`monthly_avgs_2019-2024`</span></span>
<span><span class="co">#&gt;        disease  Jan    Feb    Mar    Apr    May    Jun    Jul  Aug    Sep</span></span>
<span><span class="co">#&gt; 1   Chickenpox 23.5 22.333 21.000 26.667 19.833 19.167 24.167 20.0 18.833</span></span>
<span><span class="co">#&gt; 2 Lyme disease  0.0  0.000  0.000  0.000  0.000  0.000  0.000  0.0  0.000</span></span>
<span><span class="co">#&gt; 3      Measles 27.0 31.500 24.667 34.833 25.667 24.667 37.333 27.5 28.167</span></span>
<span><span class="co">#&gt;      Oct    Nov    Dec</span></span>
<span><span class="co">#&gt; 1 25.333 19.000 22.500</span></span>
<span><span class="co">#&gt; 2  0.000  0.000  0.000</span></span>
<span><span class="co">#&gt; 3 36.333 29.167 28.667</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$ytd_counts</span></span>
<span><span class="co">#&gt;        disease Current_YTD_Counts Avg_5yr_YTD_Counts</span></span>
<span><span class="co">#&gt; 1   Chickenpox                292              256.4</span></span>
<span><span class="co">#&gt; 2 Lyme disease                  0                0.0</span></span>
<span><span class="co">#&gt; 3      Measles                304              365.8</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew Pulsipher, Centers for Disease Control and Prevention’s Center for Forecasting and Outbreak Analytics.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
